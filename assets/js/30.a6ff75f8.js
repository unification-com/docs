(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{311:function(a,s,t){"use strict";t.r(s);var e=t(14),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"fully-sync-mainnet-from-legacy-to-current"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fully-sync-mainnet-from-legacy-to-current"}},[a._v("#")]),a._v(" Fully sync MainNet from Legacy to Current")]),a._v(" "),s("p",[a._v("It is entirely possible - should you wish - to set up and fully sync a "),s("code",[a._v("MainNet")]),a._v(" node from the original\n"),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" genesis, right up to the current block.")]),a._v(" "),s("p",[a._v("This guide will cover the necessary steps for those who prefer to do so.")]),a._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[a._v("WARNING")]),a._v(" "),s("p",[a._v("To fully sync the chain from "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" will take several days (or weeks) and require a significant\namount of disk space! Ensure you have at least 300Gb disk space available to allow for syncs, and upwards of 500Gb if\nbackups are required.")])]),a._v(" "),s("p",[a._v("There are several steps required, some of which will require manual intervention:")]),a._v(" "),s("ol",[s("li",[a._v("Initialise the node using "),s("code",[a._v("und")]),a._v(" v1.4.8 & Synchronise from "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" genesis to block 11,039,060")]),a._v(" "),s("li",[a._v("Export and migrate the state from block 11,039,060 to the "),s("code",[a._v("FUND-MainNet-2")]),a._v(" genesis using "),s("code",[a._v("und")]),a._v(" v1.4.9")]),a._v(" "),s("li",[a._v("Set up and initialise Cosmovisor, and the current "),s("code",[a._v("und")]),a._v(" binaries (v1.5.x, v1.6.x etc.)")]),a._v(" "),s("li",[a._v("Sync from "),s("code",[a._v("FUND-MainNet-2")]),a._v(" genesis to the current block")])]),a._v(" "),s("h2",{attrs:{id:"_1-initialise-sync-fund-mainchain-mainnet-v1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-initialise-sync-fund-mainchain-mainnet-v1"}},[a._v("#")]),a._v(" 1. Initialise & sync "),s("code",[a._v("FUND-Mainchain-MainNet-v1")])]),a._v(" "),s("p",[s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" ran for just over 2 years, and resulted in 11,039,060 blocks. The first step is to\ninitialise your node using "),s("code",[a._v("und")]),a._v(" v1.4.8, and synchronise it from genesis to block 11,039,060. In addition to the\nLegacy RPC, REST and Explorers, the Unification Foundation maintains a Legacy node dedicated to P2P to allow for this.")]),a._v(" "),s("h3",{attrs:{id:"install-dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-dependencies"}},[a._v("#")]),a._v(" Install dependencies")]),a._v(" "),s("p",[a._v("Update, e.g.")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt")]),a._v(" update "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n")])])]),s("p",[s("code",[a._v("git")]),a._v(" and "),s("code",[a._v("make")]),a._v(" are required dependencies for building. "),s("code",[a._v("curl")]),a._v(" and/or "),s("code",[a._v("wget")]),a._v(" are recommended, and "),s("code",[a._v("jq")]),a._v(" is useful for\nquickly looking up values in, for example "),s("code",[a._v("genesis.json")])]),a._v(" "),s("p",[a._v("These can all be installed via your package manager, for example:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" jq\n")])])]),s("p",[a._v("or")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("make")]),a._v(" jq\n")])])]),s("h3",{attrs:{id:"download-und-v1-4-8"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#download-und-v1-4-8"}},[a._v("#")]),a._v(" Download "),s("code",[a._v("und")]),a._v(" v1.4.8")]),a._v(" "),s("p",[a._v("Download and install "),s("code",[a._v("und")]),a._v(" v1.4.8:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" legacy/v1.4.8 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" legacy/v1.4.8\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/unification-com/mainchain/releases/download/1.4.8/und_v1.4.8_linux_x86_64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" und_v1.4.8_linux_x86_64.tar.gz\n")])])]),s("h3",{attrs:{id:"initialise-your-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initialise-your-node"}},[a._v("#")]),a._v(" Initialise your node")]),a._v(" "),s("p",[a._v("Next, initialise the node and its configuration files:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/legacy/v1.4.8/und init my-node\n")])])]),s("p",[a._v("Modify "),s("code",[a._v("my-node")]),a._v(" accordingly, to a suitable moniker for your node.")]),a._v(" "),s("h3",{attrs:{id:"download-and-check-fund-mainchain-mainnet-v1-genesis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#download-and-check-fund-mainchain-mainnet-v1-genesis"}},[a._v("#")]),a._v(" Download and check "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" genesis")]),a._v(" "),s("p",[a._v("We'll need the "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" genesis file to start with:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" https://raw.githubusercontent.com/unification-com/mainnet/master/legacy/0.38/latest/genesis.json "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/genesis.json\n")])])]),s("p",[a._v("and check the Chain ID is "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("jq --raw-output "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'.chain_id'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/genesis.json\n")])])]),s("h3",{attrs:{id:"configure-p2p-connection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-p2p-connection"}},[a._v("#")]),a._v(" Configure P2P connection")]),a._v(" "),s("p",[a._v("There are no seed nodes for "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(". Instead, we'll set the Foundation's Legacy P2P node\nas a persistent peer. Open "),s("code",[a._v("$HOME/.und_mainchain/config/config.toml")]),a._v(" with a text editor, for example "),s("code",[a._v("nano")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/config.toml\n")])])]),s("p",[a._v("In the "),s("code",[a._v("[p2p]")]),a._v(" section, set "),s("code",[a._v("persistent_peers")]),a._v(" as follows, and save:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("persistent_peers "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"6e9fe5b2aed55bc322d8a90a8a011b45c70c076d@legacy-fund-mainnet-v1-p2p.unification.io:26656"')]),a._v("\n")])])]),s("h3",{attrs:{id:"configure-application-settings"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-application-settings"}},[a._v("#")]),a._v(" Configure Application settings")]),a._v(" "),s("p",[a._v("Next, the "),s("code",[a._v("app.toml")]),a._v(" needs some configuring:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/app.toml\n")])])]),s("p",[a._v("Find and set the following values:")]),a._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("minimum-gas-prices")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0.25nund"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("halt-height")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11039060")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("pruning")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"everything"')]),a._v("\n")])])]),s("h3",{attrs:{id:"configure-und-to-run-as-a-systemd-service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-und-to-run-as-a-systemd-service"}},[a._v("#")]),a._v(" Configure "),s("code",[a._v("und")]),a._v(" to run as a "),s("code",[a._v("systemd")]),a._v(" service")]),a._v(" "),s("p",[a._v("To allow "),s("code",[a._v("und")]),a._v(" to run as a background service, it's recommended to create and maintain a "),s("code",[a._v("systemd")]),a._v(" service. Create the\nservice file:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" /etc/systemd/system/und.service\n")])])]),s("p",[a._v("Containing the following minimal configuration:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Unit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Description")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Unification Mainchain Validator Node\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("User")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ubuntu\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Group")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ubuntu\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("WorkingDirectory")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/ubuntu\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ExecStart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/ubuntu/legacy/v1.4.8/und start\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Restart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("on-failure\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RestartSec")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("10s\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LimitNOFILE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Install"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("WantedBy")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("default.target\n")])])]),s("p",[a._v("Modify as required, taking particular notice to the "),s("code",[a._v("User")]),a._v(", "),s("code",[a._v("Group")]),a._v(", "),s("code",[a._v("WorkingDirectory")]),a._v(" and "),s("code",[a._v("ExecStart")]),a._v(" values.")]),a._v(" "),s("p",[a._v("Finally, install the service:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl daemon-reload\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" und\n")])])]),s("p",[a._v("and run it:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start und\n")])])]),s("p",[a._v("You can now monitor the sync progress with:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" und "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v("\n")])])]),s("p",[a._v("Once it reaches block 11,039,060, the node will stop and exit.")]),a._v(" "),s("h2",{attrs:{id:"_2-export-and-migrate-fund-mainchain-mainnet-v1-to-fund-mainnet-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-export-and-migrate-fund-mainchain-mainnet-v1-to-fund-mainnet-2"}},[a._v("#")]),a._v(" 2. Export and Migrate "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" to "),s("code",[a._v("FUND-MainNet-2")])]),a._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[a._v("IMPORTANT")]),a._v(" "),s("p",[a._v("Do not proceed with the following steps until your node has fully synced up to block 11,039,060. Doing so will result in\nan incorrect "),s("code",[a._v("FUND-MainNet-2")]),a._v(" genesis export! Do not stop the node until you see the following in the "),s("code",[a._v("journalctl")]),a._v("\nlogs:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("halting "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("node")]),a._v(" per configuration               "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("module")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("main "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("height")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11039060")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("time")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\nCommitted state                              "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("module")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("state "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("height")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11039060")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("txs")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("appHash")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("EB8ECEBAC7D1B84B459BA5541C108B3687C045E340B2D4044638E23A7F06009B\n")])])]),s("p",[a._v("Fully syncing the legacy chain will take several days, if not weeks to complete!")])]),a._v(" "),s("p",[a._v("Once "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" has been fully synced, it will be possible to run the first upgrade. This upgrade was\noriginally run on Wednesday 8th June 2022 at 11:00:00 GMT+0000, and the exact steps run by validators will be\nimplemented here.")]),a._v(" "),s("p",[a._v("Stop the "),s("code",[a._v("systemd")]),a._v(" service:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl stop und\n")])])]),s("h3",{attrs:{id:"optionally-backup-the-und-mainchain-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#optionally-backup-the-und-mainchain-directory"}},[a._v("#")]),a._v(" Optionally backup the "),s("code",[a._v(".und_mainchain")]),a._v(" directory")]),a._v(" "),s("p",[a._v("Backups are always a good idea. Use "),s("code",[a._v("rsync")]),a._v(", or "),s("code",[a._v("tar")]),a._v(" to backup, for example:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-av")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/ "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/und_mainchain_BAK/\n")])])]),s("p",[a._v("Or")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-cpzf")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/und_mainchain.backup.tar.gz *\n")])])]),s("p",[a._v("The backup may consume 90Gb - 150Gb disk space, but can be deleted after a successful upgrade/migration.")]),a._v(" "),s("h3",{attrs:{id:"download-und-v1-4-9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#download-und-v1-4-9"}},[a._v("#")]),a._v(" Download "),s("code",[a._v("und")]),a._v(" v1.4.9")]),a._v(" "),s("p",[s("code",[a._v("und")]),a._v(" v1.4.9 was used to export the "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" chain state to a new genesis.")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" legacy/v1.4.9 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" legacy/v1.4.9\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/unification-com/mainchain/releases/download/1.4.9/und_v1.4.9_linux_x86_64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" und_v1.4.9_linux_x86_64.tar.gz\n")])])]),s("h3",{attrs:{id:"export-the-fund-mainchain-mainnet-v1-chain-state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#export-the-fund-mainchain-mainnet-v1-chain-state"}},[a._v("#")]),a._v(" Export the "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" chain state")]),a._v(" "),s("p",[a._v("Export the current chain state to the new genesis. Effectively, all accounts,\nwallets, balances and all other chain data at block 11,039,060 were exported to a new genesis block, such that the\nentire chain state at block 11,039,060 becomes the new block 0 for "),s("code",[a._v("FUND-MainNet-2")]),a._v(".")]),a._v(" "),s("p",[s("strong",[a._v("You must use "),s("code",[a._v("und")]),a._v(" v1.4.9 to execute this")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/legacy/v1.4.9/und "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" --for-zero-height "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--home")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/v038_exported_state.json\n")])])]),s("h3",{attrs:{id:"download-und-v1-5-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#download-und-v1-5-1"}},[a._v("#")]),a._v(" Download "),s("code",[a._v("und")]),a._v(" v1.5.1")]),a._v(" "),s("p",[s("code",[a._v("und")]),a._v(" v1.5.1 was used to migrate the exported "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" chain state to the "),s("code",[a._v("FUND-MainNet-2")]),a._v(" genesis,\nand to run the new chain up to block 2,002,620.")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" upgrade/v1.5.1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" upgrade/v1.5.1\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/unification-com/mainchain/releases/download/1.5.1/und_v1.5.1_linux_x86_64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" und_v1.5.1_linux_x86_64.tar.gz\n")])])]),s("h3",{attrs:{id:"migrate-fund-mainchain-mainnet-v1-to-fund-mainnet-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#migrate-fund-mainchain-mainnet-v1-to-fund-mainnet-2"}},[a._v("#")]),a._v(" Migrate "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" to "),s("code",[a._v("FUND-MainNet-2")])]),a._v(" "),s("p",[a._v("Next, we need to migrate the exported "),s("code",[a._v("FUND-Mainchain-MainNet-v1")]),a._v(" chain state data to the new "),s("code",[a._v("FUND-MainNet-2")]),a._v(" genesis,\nusing "),s("code",[a._v("und")]),a._v(" v1.5.1:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/upgrade/v1.5.1/und migrate "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/v038_exported_state.json --chain-id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("FUND-MainNet-2 --genesis-time"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"2022-06-08T14:00:00Z"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--log_level")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/new_v042_genesis.json\n")])])]),s("p",[a._v("Validate the migrated genesis:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/upgrade/v1.5.1/und validate-genesis "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--log_level")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/new_v042_genesis.json\n")])])]),s("p",[a._v("should result in:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("File at new_v042_genesis.json is a valid genesis "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v("\n")])])]),s("p",[a._v("Generate a checksum:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("jq "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-S")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-M")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/new_v042_genesis.json "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" sha256sum\n")])])]),s("p",[a._v("it should result in:")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("aca9b55183c0689e38d5b75ec63064aa84df838808833736c70b12c93adf323f\n")])])]),s("p",[a._v("Reset the chain data for your node:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/upgrade/v1.5.1/und unsafe-reset-all "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--log_level")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--home")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain\n")])])]),s("p",[a._v("Copy the new genesis file to replace the old version in "),s("code",[a._v("$HOME/.und_mainchain/config")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/new_v042_genesis.json "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/genesis.json\n")])])]),s("p",[a._v("Download the new Cosmos SDK v0.42 formatted "),s("code",[a._v("app.toml")]),a._v(" and replace your old version in "),s("code",[a._v("$HOME/.und_mainchain/config")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" https://raw.githubusercontent.com/unification-com/mainnet/master/latest/042_app.toml "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/app.toml\n")])])]),s("p",[a._v("Modify as required:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/app.toml\n")])])]),s("p",[a._v("To aid the network, it's worth setting some values in the "),s("code",[a._v("[state-sync]")]),a._v(" section in "),s("code",[a._v("app.toml")]),a._v(", for example:")]),a._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("snapshot-interval")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("500")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("snapshot-keep-recent")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v("\n")])])]),s("p",[a._v("Finally, change the "),s("code",[a._v("log_level")]),a._v(" in "),s("code",[a._v("$HOME/.und_mainchain/config/config.toml")]),a._v(", as the variable format has changed in\nCosmos SDK 0.42.x, and modify the "),s("code",[a._v("sseds")]),a._v(" and `persistent_peers:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/config/config.toml\n")])])]),s("p",[a._v("set:")]),a._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("log_level")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"info"')]),a._v("\n")])])]),s("p",[a._v("also, in the "),s("code",[a._v("[p2p]")]),a._v(" section, set:")]),a._v(" "),s("div",{staticClass:"language-toml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-toml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("seeds")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"0c2b65bc604a18a490f5f55bb7b4140cfb512ced@seed1.unification.io:26656,e66e0f89af19da09f676c85b262d591b8c2bb9d8@seed2.unification.io:26656"')]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key property"}},[a._v("persistent_peers")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v("\n")])])]),s("p",[s("strong",[a._v("Note:")]),a._v(" if you have a list of "),s("code",[a._v("persistent_peers")]),a._v(", you can add them too.")]),a._v(" "),s("h2",{attrs:{id:"_3-configure-and-migrate-to-cosmovisor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-configure-and-migrate-to-cosmovisor"}},[a._v("#")]),a._v(" 3. Configure and Migrate to Cosmovisor")]),a._v(" "),s("p",[a._v("Now that the fundamentals are in place, we can migrate the running and management of the "),s("code",[a._v("und")]),a._v(" daemon to Cosmovisor,\nand continue syncing the chain until it's up-to-date.")]),a._v(" "),s("h3",{attrs:{id:"install-cosmovisor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#install-cosmovisor"}},[a._v("#")]),a._v(" Install Cosmovisor")]),a._v(" "),s("p",[a._v("First, install "),s("code",[a._v("cosmovisor")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/tmp "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/tmp\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/cosmos/cosmos-sdk/releases/download/cosmovisor%2Fv1.5.0/cosmovisor-v1.5.0-linux-amd64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" cosmovisor-v1.5.0-linux-amd64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" cosmovisor /usr/local/bin/cosmovisor\n")])])]),s("h3",{attrs:{id:"set-up-cosmovisor-directory-structure"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#set-up-cosmovisor-directory-structure"}},[a._v("#")]),a._v(" Set up cosmovisor directory structure")]),a._v(" "),s("p",[a._v("Next, we need to set up some directories and "),s("code",[a._v("und")]),a._v(" binaries for Cosmovisor to work with:")]),a._v(" "),s("h4",{attrs:{id:"und-v1-5-1-genesis"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#und-v1-5-1-genesis"}},[a._v("#")]),a._v(" "),s("code",[a._v("und")]),a._v(" v1.5.1 -> "),s("code",[a._v("genesis")]),a._v(":")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/cosmovisor/genesis/bin\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/upgrade/v1.5.1/und "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/cosmovisor/genesis/bin\n")])])]),s("h4",{attrs:{id:"und-v1-6-x-1-init-ibc-update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#und-v1-6-x-1-init-ibc-update"}},[a._v("#")]),a._v(" "),s("code",[a._v("und")]),a._v(" v1.6.x -> "),s("code",[a._v("1-init_ibc")]),a._v(" update")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/upgrade/v1.6.3 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&&")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/upgrade/v1.6.3\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://github.com/unification-com/mainchain/releases/download/v1.6.3/und_v1.6.3_linux_x86_64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" und_v1.6.3_linux_x86_64.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/cosmovisor/upgrades/1-init_ibc/bin\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" und "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/cosmovisor/upgrades/1-init_ibc/bin\n")])])]),s("h3",{attrs:{id:"create-cosmovisor-environment-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-cosmovisor-environment-file"}},[a._v("#")]),a._v(" Create cosmovisor environment file")]),a._v(" "),s("p",[a._v("Create an environment variable file which will load into the "),s("code",[a._v("systemd")]),a._v(" service, modifying "),s("code",[a._v("/FULL/PATH/TO/")]),a._v(" as\nrequired:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tee")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$HOME")]),a._v("/.und_mainchain/cosmovisor/UND_COSMOVISOR_ENV "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" /dev/null "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<<")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("EOF\nDAEMON_NAME=und\nDAEMON_HOME=/FULL/PATH/TO/.und_mainchain\nDAEMON_RESTART_AFTER_UPGRADE=true\nDAEMON_RESTART_DELAY=5s\nEOF")]),a._v("\n")])])]),s("h3",{attrs:{id:"edit-systemd-service-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#edit-systemd-service-file"}},[a._v("#")]),a._v(" Edit systemd service file")]),a._v(" "),s("p",[a._v("Open the "),s("code",[a._v("und.service")]),a._v(" file in a text editor")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nano")]),a._v(" /etc/systemd/system/und.service\n")])])]),s("p",[a._v("Add the "),s("code",[a._v("EnvironmentFile")]),a._v(" directive to the "),s("code",[a._v("[Service]")]),a._v(" section using the full, absolute path to "),s("code",[a._v("UND_COSMOVISOR_ENV")]),a._v(",\nfor example:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("EnvironmentFile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/ubuntu/.und_mainchain/cosmovisor/UND_COSMOVISOR_ENV\n")])])]),s("p",[a._v("Edit the "),s("code",[a._v("ExecStart")]),a._v(" directive, replacing "),s("code",[a._v("/path/to/und start")]),a._v(" with "),s("code",[a._v("/usr/local/bin/cosmovisor run")]),a._v(", for example:")]),a._v(" "),s("p",[a._v("change:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ExecStart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/ubuntu/legacy/v1.4.8/und start\n")])])]),s("p",[a._v("to:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ExecStart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/bin/cosmovisor run start\n")])])]),s("p",[a._v("Your service file should now look something along the lines of:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Unit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Description")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Unification Mainchain Validator Node\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("User")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ubuntu\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Group")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ubuntu\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("WorkingDirectory")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/ubuntu\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("EnvironmentFile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/ubuntu/.und_mainchain/cosmovisor/UND_COSMOVISOR_ENV\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("ExecStart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/usr/local/bin/cosmovisor run start\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("Restart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("on-failure\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("RestartSec")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("10s\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("LimitNOFILE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Install"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("WantedBy")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("default.target\n")])])]),s("h2",{attrs:{id:"_4-reload-the-daemon-and-sync"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-reload-the-daemon-and-sync"}},[a._v("#")]),a._v(" 4. Reload the daemon and sync!")]),a._v(" "),s("p",[a._v("Finally, we can reload the "),s("code",[a._v("systemd")]),a._v(" service file changes:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl daemon-reload\n")])])]),s("p",[a._v("then restart the "),s("code",[a._v("und")]),a._v(" service:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl start und\n")])])]),s("p",[a._v("Finally, monitor progress with:")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" journalctl "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" und "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v("\n")])])]),s("p",[a._v("Cosmovisor will automatically handle any upgrades (for example, v1.5.1 -> v1.6.x).")]),a._v(" "),s("p",[s("strong",[a._v("Note:")]),a._v(" your node may still take several more days to fully sync!")])])}),[],!1,null,null,null);s.default=n.exports}}]);