(window.webpackJsonp=window.webpackJsonp||[]).push([[467],{747:function(e,t,r){"use strict";r.r(t);var a=r(14),s=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"ooo-data-consumer-demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ooo-data-consumer-demo"}},[e._v("#")]),e._v(" OoO Data Consumer Demo")]),e._v(" "),t("p",[e._v('Note the "is ConsumerBase", to extend\nhttps://github.com/unification-com/xfund-router/blob/main/contracts/lib/ConsumerBase.sol\nConsumerBase.sol interacts with the deployed Router.sol smart contract\nwhich will route data requests and fee payment to the selected provider\nand handle data fulfilment.')]),e._v(" "),t("p",[e._v("The selected provider will listen to the Router for requests, then send the data\nback to the Router, which will in turn forward the data to your smart contract\nafter verifying the source of the data.")]),e._v(" "),t("h2",{attrs:{id:"functions"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#functions"}},[e._v("#")]),e._v(" Functions:")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#DemoConsumer2-constructor-address-address-address-uint256-"}},[t("code",[e._v("constructor(address _router, address _xfund, address _provider, uint256 _fee) public")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-setProvider-address-"}},[t("code",[e._v("setProvider(address _provider) external")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-setFee-uint256-"}},[t("code",[e._v("setFee(uint256 _fee) external")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-requestData-bytes32-string-"}},[t("code",[e._v("requestData(bytes32 _data, string pair) external")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-getPrice-string-"}},[t("code",[e._v("getPrice(string pair) external")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-increaseRouterAllowance-uint256-"}},[t("code",[e._v("increaseRouterAllowance(uint256 _amount) external")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-setRouter-address-"}},[t("code",[e._v("setRouter(address _router) external")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-withdrawxFund-address-uint256-"}},[t("code",[e._v("withdrawxFund(address _to, uint256 _value) external")])])]),e._v(" "),t("li",[t("a",{attrs:{href:"#DemoConsumer2-receiveData-uint256-bytes32-"}},[t("code",[e._v("receiveData(uint256 _price, bytes32 _requestId) internal")])])])]),e._v(" "),t("p",[t("a",{attrs:{name:"DemoConsumer2-constructor-address-address-address-uint256-"}})]),e._v(" "),t("h3",{attrs:{id:"function-constructor-address-router-address-xfund-address-provider-uint256-fee-public"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-constructor-address-router-address-xfund-address-provider-uint256-fee-public"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("constructor(address _router, address _xfund, address _provider, uint256 _fee) public")])]),e._v(" "),t("p",[e._v("constructor must pass the address of the Router and xFUND smart\ncontracts to the constructor of your contract! Without it, this contract\ncannot interact with the system, nor request/receive any data.\nThe constructor calls the parent ConsumerBase constructor to set these.")]),e._v(" "),t("h4",{attrs:{id:"parameters"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("p",[t("code",[e._v("_router")]),e._v(": address of the Router smart contract")])]),e._v(" "),t("li",[t("p",[t("code",[e._v("_xfund")]),e._v(": address of the xFUND smart contract")])]),e._v(" "),t("li",[t("p",[t("code",[e._v("_provider")]),e._v(": address of the default provider")])]),e._v(" "),t("li",[t("p",[t("code",[e._v("_fee")]),e._v(": uint256 default fee\n"),t("a",{attrs:{name:"DemoConsumer2-setProvider-address-"}})])])]),e._v(" "),t("h3",{attrs:{id:"function-setprovider-address-provider-external"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-setprovider-address-provider-external"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("setProvider(address _provider) external")])]),e._v(" "),t("p",[e._v("setProvider change default provider. Uses OpenZeppelin's\nonlyOwner modifier to secure the function.")]),e._v(" "),t("h4",{attrs:{id:"parameters-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters-2"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("_provider")]),e._v(": address of the default provider\n"),t("a",{attrs:{name:"DemoConsumer2-setFee-uint256-"}})])]),e._v(" "),t("h3",{attrs:{id:"function-setfee-uint256-fee-external"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-setfee-uint256-fee-external"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("setFee(uint256 _fee) external")])]),e._v(" "),t("p",[e._v("setFee change default fee. Uses OpenZeppelin's\nonlyOwner modifier to secure the function.")]),e._v(" "),t("h4",{attrs:{id:"parameters-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters-3"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("_fee")]),e._v(": uint256 default fee\n"),t("a",{attrs:{name:"DemoConsumer2-requestData-bytes32-string-"}})])]),e._v(" "),t("h3",{attrs:{id:"function-requestdata-bytes32-data-string-pair-external"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-requestdata-bytes32-data-string-pair-external"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("requestData(bytes32 _data, string pair) external")])]),e._v(" "),t("p",[e._v("getData the actual function to request data.")]),e._v(" "),t("p",[e._v("NOTE: Calls ConsumerBase.sol's requestData function.")]),e._v(" "),t("p",[e._v("Uses OpenZeppelin's onlyOwner modifier to secure the function.\nThe data format can be found at\nhttps://docs.finchains.io/guide/ooo_api.html\nEndpoints should be Hex encoded using, for example\nthe web3.utils.asciiToHex function.")]),e._v(" "),t("h4",{attrs:{id:"parameters-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters-4"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("_data")]),e._v(": bytes32 data being requested.\n"),t("a",{attrs:{name:"DemoConsumer2-getPrice-string-"}})])]),e._v(" "),t("h3",{attrs:{id:"function-getprice-string-pair-external-uint256"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-getprice-string-pair-external-uint256"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("getPrice(string pair) external -> uint256")])]),e._v(" "),t("p",[e._v("getPrice returns the current price")]),e._v(" "),t("h4",{attrs:{id:"return-values"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#return-values"}},[e._v("#")]),e._v(" Return Values:")]),e._v(" "),t("ul",[t("li",[e._v("price uint256\n"),t("a",{attrs:{name:"DemoConsumer2-increaseRouterAllowance-uint256-"}})])]),e._v(" "),t("h3",{attrs:{id:"function-increaserouterallowance-uint256-amount-external"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-increaserouterallowance-uint256-amount-external"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("increaseRouterAllowance(uint256 _amount) external")])]),e._v(" "),t("p",[e._v("increaseRouterAllowance allows the Router to spend xFUND on behalf of this\nsmart contract.")]),e._v(" "),t("p",[e._v("NOTE: Calls the internal _increaseRouterAllowance function in ConsumerBase.sol.")]),e._v(" "),t("p",[e._v("Required so that xFUND fees can be paid. Uses OpenZeppelin's onlyOwner modifier\nto secure the function.")]),e._v(" "),t("h4",{attrs:{id:"parameters-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters-5"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("_amount")]),e._v(": uint256 amount to increase\n"),t("a",{attrs:{name:"DemoConsumer2-setRouter-address-"}})])]),e._v(" "),t("h3",{attrs:{id:"function-setrouter-address-router-external"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-setrouter-address-router-external"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("setRouter(address _router) external")])]),e._v(" "),t("p",[e._v("setRouter allows updating the Router contract address")]),e._v(" "),t("p",[e._v("NOTE: Calls the internal setRouter function in ConsumerBase.sol.")]),e._v(" "),t("p",[e._v("Can be used if network upgrades require new Router deployments.\nUses OpenZeppelin's onlyOwner modifier to secure the function.")]),e._v(" "),t("h4",{attrs:{id:"parameters-6"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters-6"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("_router")]),e._v(": address new Router address\n"),t("a",{attrs:{name:"DemoConsumer2-withdrawxFund-address-uint256-"}})])]),e._v(" "),t("h3",{attrs:{id:"function-withdrawxfund-address-to-uint256-value-external"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-withdrawxfund-address-to-uint256-value-external"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("withdrawxFund(address _to, uint256 _value) external")])]),e._v(" "),t("p",[e._v("increaseRouterAllowance allows contract owner to withdraw\nany xFUND held in this contract.\nUses OpenZeppelin's onlyOwner modifier to secure the function.")]),e._v(" "),t("h4",{attrs:{id:"parameters-7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters-7"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("p",[t("code",[e._v("_to")]),e._v(": address recipient")])]),e._v(" "),t("li",[t("p",[t("code",[e._v("_value")]),e._v(": uint256 amount to withdraw\n"),t("a",{attrs:{name:"DemoConsumer2-receiveData-uint256-bytes32-"}})])])]),e._v(" "),t("h3",{attrs:{id:"function-receivedata-uint256-price-bytes32-requestid-internal"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#function-receivedata-uint256-price-bytes32-requestid-internal"}},[e._v("#")]),e._v(" Function "),t("code",[e._v("receiveData(uint256 _price, bytes32 _requestId) internal")])]),e._v(" "),t("p",[e._v("recieveData - example end user function to receive data. This will be called\nby the data provider, via the Router's fulfillRequest, and through the ConsumerBase's\nrawReceiveData function.")]),e._v(" "),t("p",[e._v("Note: validation of the data and data provider sending the data is handled\nby the Router smart contract prior to it forwarding the data to your contract, allowing\ndevs to focus on pure functionality. ConsumerBase.sol's rawReceiveData\nfunction can only be called by the Router smart contract.")]),e._v(" "),t("h4",{attrs:{id:"parameters-8"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#parameters-8"}},[e._v("#")]),e._v(" Parameters:")]),e._v(" "),t("ul",[t("li",[t("p",[t("code",[e._v("_price")]),e._v(": uint256 result being sent")])]),e._v(" "),t("li",[t("p",[t("code",[e._v("_requestId")]),e._v(": bytes32 request ID of the request being fulfilled")])])])])}),[],!1,null,null,null);t.default=s.exports}}]);